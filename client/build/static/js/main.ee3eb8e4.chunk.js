(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{118:function(e,t){},136:function(e,t,a){"use strict";a.r(t);var n,c=a(0),r=a.n(c),l=a(57),o=a.n(l),s=a(12),u=a(1),i=a(6),m=a.n(i),p=a(8),f=a(2),h=a(7),d=a.n(h),E=(a(14),function(){var e=Object(u.e)(),t=Object(c.useState)(),a=Object(f.a)(t,2),n=a[0],l=a[1],o=Object(c.useState)(),s=Object(f.a)(o,2),i=s[0],h=s[1],E=Object(c.useState)(null),b=Object(f.a)(E,2),g=b[0],v=b[1],j=function(){var t=Object(p.a)(m.a.mark((function t(a){var c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,d.a.post("http://localhost:5000/register",{user_name:n,user_password:i});case 3:(c=t.sent).data.authToken?(localStorage.setItem("auth",c.data.authToken),localStorage.setItem("id",c.data.userId),localStorage.setItem("name",n),console.log(c.data),e.push("/join")):v(c.data.message);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h1",null,"Sign Up"),r.a.createElement("div",null,r.a.createElement("label",{for:"fname"},"Nick Name"),r.a.createElement("input",{type:"text",onChange:function(e){l(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{for:"password"},"Password"),r.a.createElement("input",{type:"password",onChange:function(e){h(e.target.value)}})),r.a.createElement("button",{onClick:function(e){j(e)}},"Sign Up"),null!==g&&r.a.createElement("p",null,g))}),b=function(){var e=Object(u.e)(),t=Object(c.useState)(),a=Object(f.a)(t,2),n=a[0],l=a[1],o=Object(c.useState)(),s=Object(f.a)(o,2),i=s[0],h=s[1],E=Object(c.useState)(null),b=Object(f.a)(E,2),g=b[0],v=b[1],j=function(){var t=Object(p.a)(m.a.mark((function t(a){var c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,d.a.post("http://localhost:5000/login",{user_name:n,user_password:i});case 3:(c=t.sent).data.authToken?(localStorage.setItem("auth",c.data.authToken),localStorage.setItem("id",c.data.userId),localStorage.setItem("name",n),console.log(c.data),e.push("/join")):v(c.data.message);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h1",null,"Login"),r.a.createElement("div",null,r.a.createElement("label",{for:"fname"},"Nick Name"),r.a.createElement("input",{type:"text",onChange:function(e){l(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{for:"password"},"Password"),r.a.createElement("input",{type:"password",onChange:function(e){h(e.target.value)}})),r.a.createElement("div",null,"Not have an account? ",r.a.createElement("a",{href:"/register"},"Here")," to sign up."),r.a.createElement("button",{onClick:function(e){j(e)}},"Login"),null!==g&&r.a.createElement("p",null,g))},g=a(61),v=a(59),j=a.n(v),O=a(60),S=function(e){var t=e.name,a=e.room,l=e.partner,o=Object(c.useState)([]),s=Object(f.a)(o,2),u=s[0],i=s[1],m=Object(c.useState)(""),p=Object(f.a)(m,2),h=p[0],d=p[1],E=Object(c.useState)([]),b=Object(f.a)(E,2),v=b[0],S=b[1];Object(c.useEffect)((function(){return(n=j()("http://localhost:5000")).emit("join",{name:t,room:a},(function(){})),n.on("message_records",(function(e){i(e.user_chats)})),function(){i([]),n.emit("disconnect"),n.off()}}),["http://localhost:5000",t,a]),Object(c.useEffect)((function(){n.on("message",(function(e){i([].concat(Object(g.a)(u),[e]))}))}),[u]);return r.a.createElement("div",{className:"chatBox"},r.a.createElement("h1",null,"Chat with ",l),r.a.createElement(O.Scrollbars,{style:{height:500}},0!==u.length&&u.map((function(e){return r.a.createElement("div",{className:e.sender_name===t?"self":"partner",key:e._id},r.a.createElement("div",{className:"message"},e.message),r.a.createElement("div",{className:"time"},e.time))}))),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("textarea",{rows:"10",className:"inputTextarea",value:h,placeholder:"Type here",onChange:function(e){d(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?d(h+"\n"):null}})),null!==v&&r.a.createElement("p",null,v),r.a.createElement("div",null,r.a.createElement("button",{className:"messageSendButton",type:"text",onClick:function(e){return function(e){e.preventDefault(),""===h?S("Message can not be empty!"):n.emit("chatMessage",{time:(new Date).toLocaleString({timeZone:"Asia/Tokyo"}),message:h,room:a,sender_name:t})}(e)}},"Send"))))},k=function(){var e=Object(u.e)(),t=Object(c.useState)(null),a=Object(f.a)(t,2),n=a[0],l=a[1],o=Object(c.useState)(null),s=Object(f.a)(o,2),i=s[0],h=s[1],E=Object(c.useState)(null),b=Object(f.a)(E,2),g=b[0],v=b[1],j=Object(c.useState)("*"),O=Object(f.a)(j,2),k=O[0],w=O[1],x=Object(c.useState)(null),y=Object(f.a)(x,2),N=y[0],C=y[1],_=localStorage.getItem("name"),I=localStorage.getItem("id"),T=localStorage.getItem("auth"),L={user_name:_,id:I,authtoken:T},D=function(){var t=Object(p.a)(m.a.mark((function t(){var a,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(_&&I&&T)){t.next=12;break}return l(_),t.next=4,d.a.get("http://localhost:5000/dashboard",{headers:L});case 4:return a=t.sent,C(a.data.user_chats),t.next=8,d.a.get("http://localhost:5000/userlists",{headers:L});case 8:n=t.sent,h(n.data),t.next=13;break;case 12:e.push("/");case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),P=function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.post("http://localhost:5000/dashboard",{user_name:n,partner:g},{headers:L});case 2:t=e.sent,console.log(t.message);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){D()}),[g]),Object(c.useEffect)((function(){var e=[n,g].sort().join("*");w(e),P(),D()}),[g]),r.a.createElement("div",{className:"joinContainer"},r.a.createElement("div",{className:"recentChats"},r.a.createElement("h1",null,"Recent Chats"),null!==N&&N.length>0&&r.a.createElement("div",{className:"recentList"},N.map((function(e){return r.a.createElement("p",{onClick:function(){v(e.partner)}},e.partner)})))),r.a.createElement("div",null,"*"!==k&&r.a.createElement(S,{name:n,room:k,partner:g})),r.a.createElement("div",{className:"allContacts"}," ",r.a.createElement("div",{className:"contact",onClick:function(){localStorage.clear(),e.push("/")}},"Logout"),r.a.createElement("h1",null,"All contacts"),null!==i&&r.a.createElement("div",null,i.map((function(e){return r.a.createElement("div",{className:"contact",onClick:function(){v(e)}},e)})))))},w=function(){return r.a.createElement(s.a,null,r.a.createElement(u.a,{path:"/register",exact:!0,component:E}),r.a.createElement(u.a,{path:"/",exact:!0,component:b}),r.a.createElement(u.a,{path:"/join",exact:!0,component:k}))};o.a.render(r.a.createElement(w,null),document.querySelector("#root"))},14:function(e,t,a){},62:function(e,t,a){e.exports=a(136)}},[[62,1,2]]]);
//# sourceMappingURL=main.ee3eb8e4.chunk.js.map